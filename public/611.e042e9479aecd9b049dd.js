(self.webpackChunkvachil_booking_svcs_with_prime_ng=self.webpackChunkvachil_booking_svcs_with_prime_ng||[]).push([[611],{1611:(t,i,e)=>{"use strict";e.r(i),e.d(i,{BookingModule:()=>J});var o=e(1455),n=e(8619);let l=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"p-4"],[1,"container"]],template:function(t,i){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n._UZ(2,"router-outlet"),n.qZA(),n.qZA())},directives:[o.lC],encapsulation:2}),t})();var a=e(5108),s=e(2290),c=e(8974),r=e(1116),g=e(322),d=e(1709),u=e(1462),p=e(6726),h=e(6239),k=e(7894),Z=e(9892);function v(t,i){if(1&t){const t=n.EpF();n.TgZ(0,"div",13),n.TgZ(1,"p-calendar",14),n.NdJ("ngModelChange",function(i){return n.CHM(t),n.oxw().rangeDates=i}),n.qZA(),n.qZA()}if(2&t){const t=n.oxw();n.xp6(1),n.Q6J("ngModel",t.rangeDates)("readonlyInput",!1)}}function b(t,i){if(1&t){const t=n.EpF();n.TgZ(0,"div",15),n.TgZ(1,"button",16),n.NdJ("click",function(){n.CHM(t);const i=n.oxw();return i.adminBooking(i.rangeDates)}),n.qZA(),n.qZA()}}function D(t,i){1&t&&n._UZ(0,"div",17)}function m(t,i){if(1&t){const t=n.EpF();n.TgZ(0,"div",24),n.TgZ(1,"span",25),n._UZ(2,"i",26),n.TgZ(3,"input",27),n.NdJ("input",function(i){return n.CHM(t),n.oxw(),n.MAs(1).filterGlobal(i.target.value,"contains")}),n.qZA(),n.qZA(),n.qZA()}}function f(t,i){1&t&&(n.TgZ(0,"tr"),n.TgZ(1,"th"),n._uU(2,"Start Date"),n.qZA(),n.TgZ(3,"th"),n._uU(4,"End Date"),n.qZA(),n.TgZ(5,"th"),n._uU(6,"Image"),n.qZA(),n.TgZ(7,"th"),n._uU(8,"Price"),n.qZA(),n._UZ(9,"th"),n.qZA())}function B(t,i){if(1&t){const t=n.EpF();n.TgZ(0,"tr"),n.TgZ(1,"td"),n._uU(2),n.ALo(3,"date"),n.qZA(),n.TgZ(4,"td"),n._uU(5),n.ALo(6,"date"),n.qZA(),n.TgZ(7,"td"),n._UZ(8,"img",28),n.qZA(),n.TgZ(9,"td"),n.TgZ(10,"span",29),n._uU(11),n.ALo(12,"currency"),n.qZA(),n.qZA(),n.TgZ(13,"td"),n.TgZ(14,"button",30),n.NdJ("click",function(){const i=n.CHM(t).$implicit;return n.oxw(2).editBooking(i)}),n.qZA(),n.TgZ(15,"button",31),n.NdJ("click",function(i){const e=n.CHM(t).$implicit;return n.oxw(2).confirm(i,e)}),n.qZA(),n.TgZ(16,"button",32),n.NdJ("click",function(){const i=n.CHM(t).$implicit;return n.oxw(2).getBookingDetail(i.totalPriceID)}),n.qZA(),n.qZA(),n.qZA()}if(2&t){const t=i.$implicit,e=n.oxw(2);n.xp6(2),n.Oqu(n.lcZ(3,7,t.startDate)),n.xp6(3),n.Oqu(n.lcZ(6,9,t.endDate)),n.xp6(3),n.Q6J("src",e.getBookingVachilTotalCost(t.vachilID),n.LSH)("alt",t.vachilID),n.xp6(2),n.s9C("title",e.getToolTip(t.totalPriceID)),n.xp6(1),n.hij(" ",n.xi3(12,11,e.getBookingPrice(t.totalPriceID),"INR")," "),n.xp6(3),n.Q6J("disabled",e.isActive(t.endDate))}}function A(t,i){if(1&t&&(n.TgZ(0,"div",24),n._uU(1),n.qZA()),2&t){const t=n.oxw(2);n.xp6(1),n.hij(" In total there are ",t.allBooking?t.allBooking.length:0," Bookings. ")}}const T=function(){return["startDate","endDate","totalPriceID"]};function q(t,i){if(1&t&&(n.TgZ(0,"p-table",18,19),n.YNc(2,m,4,0,"ng-template",20),n.YNc(3,f,10,0,"ng-template",21),n.YNc(4,B,17,14,"ng-template",22),n.YNc(5,A,2,1,"ng-template",23),n.qZA()),2&t){const t=n.oxw();n.Q6J("value",t.allBooking)("rows",5)("paginator",!0)("globalFilterFields",n.DdM(6,T))("rowHover",!0)("showCurrentPageReport",!0)}}function w(t,i){1&t&&(n.TgZ(0,"div"),n.TgZ(1,"div",24),n._uU(2,"No Booking to display."),n.qZA(),n.qZA())}function x(t,i){if(1&t){const t=n.EpF();n.TgZ(0,"button",33),n.NdJ("click",function(){return n.CHM(t),n.oxw().hideDialog()}),n.qZA(),n.TgZ(1,"button",34),n.NdJ("click",function(){return n.CHM(t),n.oxw().saveBooking()}),n.qZA()}}function I(t,i){if(1&t){const t=n.EpF();n.TgZ(0,"button",33),n.NdJ("click",function(){return n.CHM(t),n.oxw(2).hideDetail()}),n.qZA(),n.TgZ(1,"button",37),n.NdJ("click",function(){return n.CHM(t),n.oxw(2).hideDetail()}),n.qZA()}}const y=function(){return{"margin-left":"80px","margin-right":"80px"}};function _(t,i){if(1&t){const t=n.EpF();n.TgZ(0,"p-dialog",35),n.NdJ("visibleChange",function(i){return n.CHM(t),n.oxw().detailDilog=i}),n.TgZ(1,"table",36),n.TgZ(2,"tbody"),n.TgZ(3,"tr"),n.TgZ(4,"th"),n._uU(5,"Total days"),n.qZA(),n.TgZ(6,"td"),n._uU(7),n.qZA(),n.qZA(),n.TgZ(8,"tr"),n.TgZ(9,"th"),n._uU(10,"24 hr cost"),n.qZA(),n.TgZ(11,"td"),n._uU(12),n.ALo(13,"currency"),n.qZA(),n.qZA(),n.TgZ(14,"tr"),n.TgZ(15,"th"),n._uU(16,"Service charge"),n.qZA(),n.TgZ(17,"td"),n._uU(18),n.ALo(19,"currency"),n.qZA(),n.qZA(),n.TgZ(20,"tr"),n.TgZ(21,"th"),n._uU(22,"Total((days*24 hr cost)+service charge)"),n.qZA(),n.TgZ(23,"td"),n._uU(24),n.ALo(25,"currency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.YNc(26,I,2,0,"ng-template",11),n.qZA()}if(2&t){const t=n.oxw();n.Akn(n.DdM(17,y)),n.Q6J("visible",t.detailDilog)("modal",!0),n.xp6(7),n.hij("",t.bookingDetail.ttl_days," days"),n.xp6(5),n.Oqu(n.xi3(13,8,t.bookingDetail.unit_price,"INR")),n.xp6(6),n.Oqu(n.xi3(19,11,t.bookingDetail.service_charge,"INR")),n.xp6(6),n.Oqu(n.xi3(25,14,t.bookingDetail.price,"INR"))}}class C{constructor(){this.allBookedVachil=[],this.allBookedPrice=[]}}class P{}const M=[{path:"",component:l,children:[{path:"",component:(()=>{class t{constructor(t,i,e,o,n,l,a){this.productService=t,this.messageService=i,this.confirmationService=e,this.acountSvcs=o,this.updateBookingSvcs=n,this.allBookingSvc=l,this.deleteBooking=a}ngOnInit(){this.isAdmin()?(this.rangeDates=[],this.rangeDates.push(new Date),this.rangeDates.push(new Date)):this.productService.fetch({id:this.acountSvcs.currentUser.id}).subscribe(t=>{this.allBooking=t.data.allBookingWithId,this.bookingVachiIdAndPrice=this.getAllBookingDetail(),this.getAllDetail()},t=>console.error(t))}isAdmin(){return this.acountSvcs.isAdmin}adminBooking(t){this.allBookingSvc.fetch({startDate:t[0],endDate:t[1]}).subscribe(t=>{console.log(t),this.allBooking=t.data.allBooking,this.bookingVachiIdAndPrice=this.getAllBookingDetail(),this.getAllDetail()},t=>console.error(t))}getAllDetail(){this.bookingDetailFull=new P,this.acountSvcs.bookingDetail(this.bookingVachiIdAndPrice).subscribe(t=>{this.bookingDetailFull.allBookedPrice=t.allBookedPrice?new Map(t.allBookedPrice.map(t=>[t.id,t])):new Map,this.bookingDetailFull.allBookedVachil=t.allBookedVachil?new Map(t.allBookedVachil.map(t=>[t.id,t.images])):new Map,console.log(this.bookingDetailFull)})}getAllBookingDetail(){let t=new C;for(let i=0;i<this.allBooking.length;i++){let e=this.allBooking[i].totalPriceID,o=this.allBooking[i].vachilID;e&&t.allBookedPrice.push(e),o&&t.allBookedVachil.push(o)}return t}openNew(){this.booking={startDate:new Date,endDate:new Date,id:0,totalPriceID:0,userID:0,vachilID:0},this.submitted=!1,this.bookingDilog=!0}editBooking(t){this.rangeDates=[],this.booking=Object.assign({},t),this.rangeDates.push(new Date(this.booking.startDate)),this.rangeDates.push(new Date(this.booking.endDate)),this.bookingDilog=!0}hideDialog(){this.bookingDilog=!1,this.submitted=!1}saveBooking(){this.submitted=!0,this.booking.startDate=this.rangeDates[0],this.booking.endDate=this.rangeDates[1],this.booking.id&&(this.updateBookingSvcs.mutate({bookingID:this.booking.id,startDate:this.booking.startDate,endDate:this.booking.endDate,userID:this.acountSvcs.currentUser.id,vachilID:this.booking.vachilID}).subscribe(t=>{var i;console.log(null===(i=t.data)||void 0===i?void 0:i.updateBooking)}),this.messageService.add({severity:"success",summary:"Successful",detail:"Booking Created",life:3e3})),this.bookingDilog=!1}confirm(t,i){let e=this.findIndexById(i.id);this.confirmationService.confirm({target:t.target,message:"Are you sure that you want to Booking?",icon:"pi pi-exclamation-triangle",accept:()=>{this.deleteBooking.mutate({bookingID:i.id}).subscribe(t=>{var i;(null===(i=t.data)||void 0===i?void 0:i.deleteBooking)&&-1!=e?(this.messageService.add({severity:"success",summary:"Successful",detail:"Booking Deleted",life:3e3}),this.allBooking.splice(e,1)):this.messageService.add({severity:"error",summary:"Error",detail:"some error occurred",life:3e3})},t=>{this.messageService.add({severity:"error",summary:"Error",detail:t,life:3e3})})},reject:()=>{}})}getBookingDetail(t){var i;this.detailDilog=!0,this.bookingDetail=(null===(i=this.bookingDetailFull.allBookedPrice)||void 0===i?void 0:i.get(t))?this.bookingDetailFull.allBookedPrice.get(t):void 0}hideDetail(){this.detailDilog=!1}findIndexById(t){let i=-1;for(let e=0;e<this.allBooking.length;e++)if(this.allBooking[e].id==t){i=e;break}return i}getBookingVachilTotalCost(t){var i;return null===(i=this.bookingDetailFull.allBookedVachil)||void 0===i?void 0:i.get(t)}getBookingPrice(t){var i,e;return(null===(i=this.bookingDetailFull.allBookedPrice)||void 0===i?void 0:i.get(t))?null===(e=this.bookingDetailFull.allBookedPrice)||void 0===e?void 0:e.get(t).price:0}getToolTip(t){var i,e,o,n,l;if(null===(i=this.bookingDetailFull.allBookedPrice)||void 0===i?void 0:i.get(t)){let i="";return i+="24 hr cost --: "+(null===(e=this.bookingDetailFull.allBookedPrice)||void 0===e?void 0:e.get(t).unit_price)+". ",i+="Total days --: "+(null===(o=this.bookingDetailFull.allBookedPrice)||void 0===o?void 0:o.get(t).ttl_days)+". ",i+="Service charge --: "+(null===(n=this.bookingDetailFull.allBookedPrice)||void 0===n?void 0:n.get(t).service_charge)+". ",i+="Total cost (Total days * 24 hr cost) + Service charge --: "+(null===(l=this.bookingDetailFull.allBookedPrice)||void 0===l?void 0:l.get(t).price),i}return""}isActive(t){let i=new Date;return new Date(t)<i}}return t.\u0275fac=function(i){return new(i||t)(n.Y36(a.E),n.Y36(s.ez),n.Y36(s.YP),n.Y36(c.BR),n.Y36(a.QC),n.Y36(a.ds),n.Y36(a.T$))},t.\u0275cmp=n.Xpm({type:t,selectors:[["ng-component"]],decls:17,vars:14,consts:[[1,"card"],[1,"row"],["class","col col-md-2",4,"ngIf"],["class","col col-md-1",4,"ngIf"],["class","col col-md-5",4,"ngIf"],[1,"col","col-md-4"],[1,"display-6","float-right"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","paginator","globalFilterFields","rowHover","showCurrentPageReport",4,"ngIf"],[4,"ngIf"],["header","Book vehicle","styleClass","p-fluid",3,"visible","modal","visibleChange"],["selectionMode","range","inputId","range","dateFormat","dd/mm/yy",3,"ngModel","readonlyInput","showTime","ngModelChange"],["pTemplate","footer"],["header","Book Detail","styleClass","p-fluid",3,"visible","style","modal","visibleChange",4,"ngIf"],[1,"col","col-md-2"],["selectionMode","range","inputId","range","dateFormat","dd/mm/yy",3,"ngModel","readonlyInput","ngModelChange"],[1,"col","col-md-1"],["pButton","","pRipple","","label","Go",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],[1,"col","col-md-5"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","paginator","globalFilterFields","rowHover","showCurrentPageReport"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[1,"p-d-flex","p-ai-center","p-jc-between"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["width","100",1,"p-shadow-4",3,"src","alt"],[3,"title"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"disabled","click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-list",1,"p-button-rounded","p-button-info",3,"click"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"],["header","Book Detail","styleClass","p-fluid",3,"visible","modal","visibleChange"],[1,"table"],["pButton","","pRipple","","label","ok","icon","pi pi-check",1,"p-button-text",3,"click"]],template:function(t,i){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.YNc(2,v,2,2,"div",2),n.YNc(3,b,2,0,"div",3),n.YNc(4,D,1,0,"div",4),n.TgZ(5,"div",5),n.TgZ(6,"span",6),n._uU(7,"Manage Bookings"),n.qZA(),n.qZA(),n.qZA(),n.YNc(8,q,6,7,"p-table",7),n.YNc(9,w,3,0,"div",8),n.qZA(),n.TgZ(10,"p-dialog",9),n.NdJ("visibleChange",function(t){return i.bookingDilog=t}),n.TgZ(11,"p-calendar",10),n.NdJ("ngModelChange",function(t){return i.rangeDates=t}),n.qZA(),n._UZ(12,"br"),n._UZ(13,"br"),n._UZ(14,"br"),n.YNc(15,x,2,0,"ng-template",11),n.qZA(),n.YNc(16,_,27,18,"p-dialog",12)),2&t&&(n.xp6(2),n.Q6J("ngIf",i.isAdmin()),n.xp6(1),n.Q6J("ngIf",i.isAdmin()),n.xp6(1),n.Q6J("ngIf",i.isAdmin()),n.xp6(4),n.Q6J("ngIf",null!=i.allBooking&&i.allBooking.length>0),n.xp6(1),n.Q6J("ngIf",null==i.allBooking||0==i.allBooking.length),n.xp6(1),n.Akn(n.DdM(13,y)),n.Q6J("visible",i.bookingDilog)("modal",!0),n.xp6(1),n.Q6J("ngModel",i.rangeDates)("readonlyInput",!1)("showTime",!0),n.xp6(5),n.Q6J("ngIf",i.bookingDetail))},directives:[r.O5,g.V,d.f,u.JJ,u.On,s.jx,p.Hq,h.H,k.iA,Z.o],pipes:[r.uU,r.H9],encapsulation:2}),t})()}]}];let N=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[o.Bz.forChild(M)],o.Bz]}),t})();var S=e(8587);let J=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[N,S.m]]}),t})()}}]);